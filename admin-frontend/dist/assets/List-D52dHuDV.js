import{d as fe,j as ce,v as _e,o as d,c as u,a as m,b as e,w as l,z as ge,l as Y,C as w,i as p,r as n,A as be,h as b,t as v,F as H,D as A,n as k,G as ve,H as ye,I as G,J as Ve,E as I,s as we,f as he}from"./index-BA-avvAI.js";import{g as U}from"./gala-9ZFv5Bwp.js";import{_ as xe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./request-DUWW7KIc.js";const ke={class:"gala-list-page page-container"},De={key:0},Te={class:"actions-bar"},Ie={class:"card"},Ue={style:{"font-size":"24px"}},je={style:{display:"flex","align-items":"center",gap:"8px"}},Ce={key:0,style:{"font-size":"32px"}},Pe={class:"tags-container"},Se={class:"tags-tip"},Be={style:{"font-size":"14px"}},Fe={key:0},Ne={key:1},Me={key:2,style:{"margin-left":"8px"}},Re={key:3,style:{"margin-left":"8px",color:"#409eff"}},Ze={key:0,class:"image-preview"},ze=["src"],Ee={key:0,class:"image-preview"},Le=["src"],$e=fe({__name:"List",setup(Ye){const W=he(),j=p("platforms"),C=p("basic"),P=p(!1),R=p([]),X=["å¤®è§†","å«è§†","ç½‘ç»œ","ä¸»ä¼šåœº","åˆ†ä¼šåœº","å…¨çƒç›´æ’­","4K","8K","VR","AR","å›½æ½®","å›½é£Ž","ä¼ ç»Ÿæ–‡åŒ–","ç§‘æŠ€åˆ›æ–°","Zä¸–ä»£","äºŒæ¬¡å…ƒ","å¹´è½»åŒ–","æ½®æµ","çŸ­è§†é¢‘","äº’åŠ¨","ç¤¾äº¤","æŽ¥åœ°æ°”","å¿«ä¹","é’æ˜¥","äº¬å‘³å„¿","å†°é›ª","æµ·æ´¾","éƒ½å¸‚","ä¸­å›½è“","è”æž"],h=p(!1),Z=p("æ–°å»ºå¹³å°"),D=p(),q=p(),J=p(),S=p(!1),T=p(null),o=ce({name:"",shortName:"",emoji:"ðŸ“º",year:new Date().getFullYear(),airDate:"",airTime:"",channel:"",logo:"",poster:"",description:"",sort:0,isShow:!0,tags:[],selectedTags:[],sourceUrl:""}),K={name:[{required:!0,message:"è¯·è¾“å…¥å¹³å°åç§°",trigger:"blur"}],year:[{required:!0,message:"è¯·è¾“å…¥å¹´ä»½",trigger:"blur"}]},z=(s,t)=>{if(!s&&!t)return"-";let f="";if(s){const x=new Date(s),c=x.getFullYear(),y=String(x.getMonth()+1).padStart(2,"0"),i=String(x.getDate()).padStart(2,"0");f=`${c}-${y}-${i}`}const V=t||"";return f&&V?`${f} ${V.substring(0,5)}`:f||V},E=s=>{const t=s.target;t.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgZmlsbD0iI2Y1ZjVmNSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiBmb250LXNpemU9IjE0IiBmaWxsPSIjOTk5Ij7liqDovb3lu5bu65Lu75oGi77ya77yaPC90ZXh0Pjwvc3ZnPg=="},B=async()=>{P.value=!0;try{const s=await U.adminGetPlatforms({});R.value=s.list||[]}catch(s){console.error("åŠ è½½å¹³å°å¤±è´¥:",s)}finally{P.value=!1}},O=()=>{Z.value="æ–°å»ºå¹³å°",T.value=null,C.value="basic",Object.assign(o,{name:"",shortName:"",emoji:"ðŸ“º",year:new Date().getFullYear(),airDate:"",airTime:"",channel:"",logo:"",poster:"",description:"",sort:0,isShow:!0,tags:[],selectedTags:[],sourceUrl:""}),h.value=!0},Q=s=>{W.push(`/content/gala/platform/${s.id}`)},ee=async()=>{if(D.value){try{await D.value.validate()}catch{return}S.value=!0;try{const s={...o,tags:o.selectedTags};T.value?(await U.updatePlatform(T.value,s),I.success("æ›´æ–°æˆåŠŸ")):(await U.createPlatform(s),I.success("åˆ›å»ºæˆåŠŸ")),h.value=!1,B()}catch(s){I.error(s.message||"æ“ä½œå¤±è´¥")}finally{S.value=!1}}},le=async s=>{try{await we.confirm(`ç¡®å®šè¦åˆ é™¤å¹³å° "${s.name}" å—ï¼Ÿ`,"æç¤º",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),await U.deletePlatform(s.id),I.success("åˆ é™¤æˆåŠŸ"),B()}catch{}},te=()=>{var s;(s=D.value)==null||s.resetFields(),T.value=null};return _e(()=>{B()}),(s,t)=>{const f=n("el-tab-pane"),V=n("el-tabs"),x=n("Plus"),c=n("el-icon"),y=n("el-button"),i=n("el-table-column"),L=n("el-tag"),ae=n("el-table"),_=n("el-input"),r=n("el-form-item"),g=n("el-col"),F=n("el-row"),$=n("el-input-number"),oe=n("el-switch"),se=n("el-option"),ne=n("el-select"),N=n("el-form"),re=n("el-date-picker"),de=n("el-time-picker"),ie=n("el-alert"),ue=n("el-dialog"),me=be("loading");return d(),u("div",ke,[t[24]||(t[24]=m("h2",{class:"page-title"},"æ˜¥æ™šç®¡ç†",-1)),e(V,{modelValue:j.value,"onUpdate:modelValue":t[0]||(t[0]=a=>j.value=a)},{default:l(()=>[e(f,{label:"æ˜¥æ™šå¹³å°",name:"platforms"})]),_:1},8,["modelValue"]),j.value==="platforms"?(d(),u("div",De,[m("div",Te,[e(y,{type:"primary",onClick:O},{default:l(()=>[e(c,null,{default:l(()=>[e(x)]),_:1}),t[18]||(t[18]=b(" æ–°å»ºå¹³å° ",-1))]),_:1})]),m("div",Ie,[ge((d(),Y(ae,{data:R.value},{default:l(()=>[e(i,{prop:"emoji",label:"å›¾æ ‡",width:"60"},{default:l(({row:a})=>[m("span",Ue,v(a.emoji||"ðŸ“º"),1)]),_:1}),e(i,{prop:"name",label:"å¹³å°åç§°","min-width":"150"}),e(i,{prop:"shortName",label:"ç®€ç§°",width:"80"}),e(i,{prop:"year",label:"å¹´ä»½",width:"80"}),e(i,{label:"æ’­å‡ºæ—¶é—´","min-width":"160"},{default:l(({row:a})=>[b(v(z(a.airDate,a.airTime)),1)]),_:1}),e(i,{prop:"channel",label:"é¢‘é“","min-width":"120"}),e(i,{prop:"tags",label:"æ ‡ç­¾","min-width":"200"},{default:l(({row:a})=>[(d(!0),u(H,null,A(a.tags,(M,pe)=>(d(),Y(L,{key:pe,size:"small",style:{"margin-right":"4px"}},{default:l(()=>[b(v(M),1)]),_:2},1024))),128))]),_:1}),e(i,{prop:"isShow",label:"æ˜¾ç¤º",width:"80"},{default:l(({row:a})=>[e(L,{type:a.isShow?"success":"info",size:"small"},{default:l(()=>[b(v(a.isShow?"æ˜¾ç¤º":"éšè—"),1)]),_:2},1032,["type"])]),_:1}),e(i,{prop:"sort",label:"æŽ’åº",width:"80"}),e(i,{label:"æ“ä½œ",width:"200",fixed:"right"},{default:l(({row:a})=>[e(y,{size:"small",onClick:M=>Q(a)},{default:l(()=>[...t[19]||(t[19]=[b("æŸ¥çœ‹è¯¦æƒ…",-1)])]),_:1},8,["onClick"]),e(y,{size:"small",type:"danger",onClick:M=>le(a)},{default:l(()=>[...t[20]||(t[20]=[b("åˆ é™¤",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[me,P.value]])])])):w("",!0),e(ue,{modelValue:h.value,"onUpdate:modelValue":t[17]||(t[17]=a=>h.value=a),title:Z.value,width:"900px",onClosed:te},{footer:l(()=>[e(y,{onClick:t[16]||(t[16]=a=>h.value=!1)},{default:l(()=>[...t[22]||(t[22]=[b("å–æ¶ˆ",-1)])]),_:1}),e(y,{type:"primary",onClick:ee,loading:S.value},{default:l(()=>[...t[23]||(t[23]=[b(" ç¡®å®š ",-1)])]),_:1},8,["loading"])]),default:l(()=>[e(V,{modelValue:C.value,"onUpdate:modelValue":t[15]||(t[15]=a=>C.value=a),class:"platform-tabs"},{default:l(()=>[e(f,{label:"åŸºæœ¬ä¿¡æ¯",name:"basic"},{default:l(()=>[e(N,{ref_key:"platformFormRef",ref:D,model:o,rules:K,"label-width":"100px",class:"platform-form"},{default:l(()=>[e(F,{gutter:20},{default:l(()=>[e(g,{span:16},{default:l(()=>[e(r,{label:"å¹³å°åç§°",prop:"name"},{default:l(()=>[e(_,{modelValue:o.name,"onUpdate:modelValue":t[1]||(t[1]=a=>o.name=a),placeholder:"å¦‚ï¼šå¤®è§†æ˜¥æ™šã€æ¹–å—æ˜¥æ™šç­‰"},null,8,["modelValue"])]),_:1})]),_:1}),e(g,{span:4},{default:l(()=>[e(r,{label:"ç®€ç§°",prop:"shortName"},{default:l(()=>[e(_,{modelValue:o.shortName,"onUpdate:modelValue":t[2]||(t[2]=a=>o.shortName=a),placeholder:"å¤®",maxlength:"1"},null,8,["modelValue"])]),_:1})]),_:1}),e(g,{span:4},{default:l(()=>[e(r,{label:"å›¾æ ‡"},{default:l(()=>[m("div",je,[o.emoji?(d(),u("span",Ce,v(o.emoji),1)):w("",!0),e(_,{modelValue:o.emoji,"onUpdate:modelValue":t[3]||(t[3]=a=>o.emoji=a),placeholder:"ðŸ“º",style:{width:"60px"}},null,8,["modelValue"])])]),_:1})]),_:1})]),_:1}),e(F,{gutter:20},{default:l(()=>[e(g,{span:8},{default:l(()=>[e(r,{label:"å¹´ä»½",prop:"year"},{default:l(()=>[e($,{modelValue:o.year,"onUpdate:modelValue":t[4]||(t[4]=a=>o.year=a),min:2e3,max:2100,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(g,{span:8},{default:l(()=>[e(r,{label:"æŽ’åº"},{default:l(()=>[e($,{modelValue:o.sort,"onUpdate:modelValue":t[5]||(t[5]=a=>o.sort=a),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(g,{span:8},{default:l(()=>[e(r,{label:"æ˜¾ç¤ºçŠ¶æ€"},{default:l(()=>[e(oe,{modelValue:o.isShow,"onUpdate:modelValue":t[6]||(t[6]=a=>o.isShow=a),"active-text":"æ˜¾ç¤º","inactive-text":"éšè—"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(r,{label:"å¹³å°æè¿°"},{default:l(()=>[e(_,{modelValue:o.description,"onUpdate:modelValue":t[7]||(t[7]=a=>o.description=a),type:"textarea",rows:4,placeholder:"è¯·è¾“å…¥å¹³å°æè¿°","show-word-limit":"",maxlength:"200"},null,8,["modelValue"])]),_:1}),e(r,{label:"æ ‡ç­¾"},{default:l(()=>[m("div",Pe,[e(ne,{modelValue:o.selectedTags,"onUpdate:modelValue":t[8]||(t[8]=a=>o.selectedTags=a),multiple:"",filterable:"","allow-create":"",placeholder:"é€‰æ‹©æˆ–è¾“å…¥æ ‡ç­¾",style:{width:"100%"}},{default:l(()=>[(d(),u(H,null,A(X,a=>e(se,{key:a,label:a,value:a},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),m("div",Se,[e(c,null,{default:l(()=>[e(k(ve))]),_:1}),t[21]||(t[21]=m("span",null,"å¯å¤šé€‰ï¼Œä¹Ÿå¯è¾“å…¥è‡ªå®šä¹‰æ ‡ç­¾",-1))])])]),_:1})]),_:1},8,["model"])]),_:1}),e(f,{label:"æ’­å‡ºä¿¡æ¯",name:"broadcast"},{default:l(()=>[e(N,{ref_key:"platformFormRef2",ref:q,model:o,"label-width":"100px",class:"platform-form"},{default:l(()=>[e(F,{gutter:20},{default:l(()=>[e(g,{span:12},{default:l(()=>[e(r,{label:"æ’­å‡ºæ—¥æœŸ"},{default:l(()=>[e(re,{modelValue:o.airDate,"onUpdate:modelValue":t[9]||(t[9]=a=>o.airDate=a),type:"date",placeholder:"é€‰æ‹©æ’­å‡ºæ—¥æœŸ",style:{width:"100%"},"value-format":"YYYY-MM-DD",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(g,{span:12},{default:l(()=>[e(r,{label:"æ’­å‡ºæ—¶é—´"},{default:l(()=>[e(de,{modelValue:o.airTime,"onUpdate:modelValue":t[10]||(t[10]=a=>o.airTime=a),placeholder:"é€‰æ‹©æ’­å‡ºæ—¶é—´",style:{width:"100%"},"value-format":"HH:mm:ss",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(r,{label:"æ’­å‡ºé¢‘é“"},{default:l(()=>[e(_,{modelValue:o.channel,"onUpdate:modelValue":t[11]||(t[11]=a=>o.channel=a),placeholder:"å¦‚ï¼šCCTV-1ã€æ¹–å—å«è§†ã€Bç«™ç­‰"},{prepend:l(()=>[e(c,null,{default:l(()=>[e(k(ye))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ie,{title:"æ’­å‡ºä¿¡æ¯é¢„è§ˆ",type:"info",closable:!1,style:{"margin-bottom":"20px"}},{default:l(()=>[m("div",Be,[o.name?(d(),u("strong",Fe,v(o.name),1)):(d(),u("span",Ne,"å¹³å°åç§°")),o.airDate||o.airTime?(d(),u("span",Me,v(z(o.airDate,o.airTime)),1)):w("",!0),o.channel?(d(),u("span",Re,v(o.channel),1)):w("",!0)])]),_:1})]),_:1},8,["model"])]),_:1}),e(f,{label:"åª’ä½“èµ„æº",name:"media"},{default:l(()=>[e(N,{ref_key:"platformFormRef3",ref:J,model:o,"label-width":"100px",class:"platform-form"},{default:l(()=>[e(r,{label:"Logoåœ°å€"},{default:l(()=>[e(_,{modelValue:o.logo,"onUpdate:modelValue":t[12]||(t[12]=a=>o.logo=a),placeholder:"/images/gala/cctv-logo.png"},{prepend:l(()=>[e(c,null,{default:l(()=>[e(k(G))]),_:1})]),_:1},8,["modelValue"]),o.logo?(d(),u("div",Ze,[m("img",{src:o.logo,alt:"Logoé¢„è§ˆ",onError:E},null,40,ze)])):w("",!0)]),_:1}),e(r,{label:"æµ·æŠ¥åœ°å€"},{default:l(()=>[e(_,{modelValue:o.poster,"onUpdate:modelValue":t[13]||(t[13]=a=>o.poster=a),placeholder:"/images/gala/cctv-poster.png"},{prepend:l(()=>[e(c,null,{default:l(()=>[e(k(G))]),_:1})]),_:1},8,["modelValue"]),o.poster?(d(),u("div",Ee,[m("img",{src:o.poster,alt:"æµ·æŠ¥é¢„è§ˆ",onError:E},null,40,Le)])):w("",!0)]),_:1}),e(r,{label:"æ•°æ®æ¥æº"},{default:l(()=>[e(_,{modelValue:o.sourceUrl,"onUpdate:modelValue":t[14]||(t[14]=a=>o.sourceUrl=a),placeholder:"æ•°æ®æ¥æºURLï¼ˆå¯é€‰ï¼‰"},{prepend:l(()=>[e(c,null,{default:l(()=>[e(k(Ve))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","title"])])}}}),Xe=xe($e,[["__scopeId","data-v-c4ae9312"]]);export{Xe as default};
