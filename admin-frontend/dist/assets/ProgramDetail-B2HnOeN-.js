import{d as oe,i as g,v as se,o as c,c as v,a as l,b as t,w as o,n as I,K as ne,t as r,C as M,F as H,m as ie,j as Y,E as h,r as u,h as b,L as re,M as de,l as O,q as ue,y as me,f as pe,s as ce}from"./index-BA-avvAI.js";import{g as k}from"./gala-9ZFv5Bwp.js";import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./request-DUWW7KIc.js";const _e={class:"program-detail-page page-container"},ve={class:"page-header"},be={class:"header-left"},ge={class:"header-info"},ye={class:"page-title"},we={key:0,class:"page-subtitle"},Ve={class:"header-actions"},he={class:"detail-section"},ke={key:0,class:"info-grid"},Te={class:"info-item"},xe={class:"value"},Ne={class:"info-item"},Ce={class:"value"},Se={class:"info-item"},De={class:"info-item"},Ie={class:"value"},Me={class:"info-item full-width"},je={class:"value"},Be={class:"info-item full-width"},Pe={class:"value"},Ae={class:"detail-section"},Ue={key:0,class:"info-grid"},Ee={class:"info-item"},$e={class:"value"},Re={class:"info-item"},ze={class:"value"},He={key:0,style:{"font-size":"20px","margin-right":"8px"}},Ye={class:"info-item"},Oe={class:"value"},qe={class:"platform-info"},Fe={key:0,style:{"font-size":"24px","margin-right":"8px"}},Ge={class:"detail-section"},Ke={class:"info-grid"},Le={class:"info-item"},Je={class:"info-item"},Qe={class:"value"},We={class:"info-item"},Xe={class:"value"},Ze=oe({__name:"ProgramDetail",setup(et){const j=ie(),B=pe(),T=g(parseInt(j.params.id)),P=g(parseInt(j.params.platformId)),x=g("basic"),f=g(!1),N=g(!1),C=g(),s=Y({id:0,title:"",type:"",performers:"",airTime:"",orderNum:0,duration:0,description:"",reviewStatus:"",createdAt:"",updatedAt:""}),m=g(null),i=Y({title:"",type:"",performers:"",airTime:"",orderNum:0,duration:0,description:""}),q={title:[{required:!0,message:"è¯·è¾“å…¥èŠ‚ç›®åç§°",trigger:"blur"}]},F={pending:"å¾…å®¡æ ¸",approved:"å·²é€šè¿‡",rejected:"å·²æ‹’ç»"},G={pending:"warning",approved:"success",rejected:"danger"},K=ue(()=>{if(!m.value)return"-";const n=m.value.airDate,e=m.value.airTime;return!n&&!e?"-":n&&e?`${n} ${e.substring(0,5)}`:n||e||"-"}),L=n=>{if(!n)return"-";const e=Math.floor(n/60),a=n%60;return e>0?`${e}åˆ†${a}ç§’`:`${a}ç§’`},A=n=>n?me(n).format("YYYY-MM-DD HH:mm"):"-",U=async()=>{var n;try{const a=(n=(await k.adminGetPrograms({platformId:P.value,reviewStatus:void 0})).list)==null?void 0:n.find(y=>y.id===T.value);a&&(Object.assign(s,{id:a.id,title:a.title,type:a.type,performers:a.performer||a.performers||"",airTime:a.airTime||a.startTime||"",orderNum:a.orderNum||0,duration:a.duration||0,description:a.description||"",reviewStatus:a.reviewStatus||"",createdAt:a.createdAt,updatedAt:a.updatedAt}),Object.assign(i,{title:a.title,type:a.type||"",performers:a.performer||a.performers||"",airTime:a.airTime||a.startTime||"",orderNum:a.orderNum||0,duration:a.duration||0,description:a.description||""}))}catch(e){console.error("åŠ è½½èŠ‚ç›®è¯¦æƒ…å¤±è´¥:",e),h.error("åŠ è½½èŠ‚ç›®è¯¦æƒ…å¤±è´¥")}},J=async()=>{var n;try{const a=(n=(await k.adminGetPlatforms({})).list)==null?void 0:n.find(y=>y.id===P.value);a&&(m.value=a)}catch(e){console.error("åŠ è½½å¹³å°ä¿¡æ¯å¤±è´¥:",e)}},Q=()=>{B.push("/content/gala")},W=()=>{f.value=!0,x.value="basic"},X=()=>{f.value=!1,Object.assign(i,{title:s.title,type:s.type,performers:s.performers,airTime:s.airTime,orderNum:s.orderNum,duration:s.duration,description:s.description})},Z=async()=>{C.value&&await C.value.validate(async n=>{if(n){N.value=!0;try{await k.updateProgram(T.value,i),h.success("æ›´æ–°æˆåŠŸ"),f.value=!1,await U()}catch(e){h.error(e.message||"æ›´æ–°å¤±è´¥")}finally{N.value=!1}}})},ee=async()=>{try{await ce.confirm(`ç¡®å®šè¦åˆ é™¤èŠ‚ç›® "${s.title}" å—ï¼Ÿ`,"æç¤º",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),await k.deleteProgram(T.value),h.success("åˆ é™¤æˆåŠŸ"),B.push("/content/gala")}catch{}};return se(async()=>{await Promise.all([U(),J()])}),(n,e)=>{const a=u("el-button"),y=u("el-icon"),E=u("el-tag"),S=u("el-input"),_=u("el-form-item"),w=u("el-col"),$=u("el-input-number"),R=u("el-row"),p=u("el-option"),te=u("el-select"),z=u("el-form"),D=u("el-tab-pane"),le=u("el-time-picker"),ae=u("el-tabs");return c(),v("div",_e,[l("div",ve,[l("div",be,[t(a,{icon:I(ne),onClick:Q},{default:o(()=>[...e[8]||(e[8]=[b("è¿”å›ž",-1)])]),_:1},8,["icon"]),l("div",ge,[l("h2",ye,r(f.value?"ç¼–è¾‘èŠ‚ç›®":"èŠ‚ç›®è¯¦æƒ…"),1),f.value?M("",!0):(c(),v("span",we,r(s.title||"åŠ è½½ä¸­..."),1))])]),l("div",Ve,[f.value?(c(),v(H,{key:1},[t(a,{onClick:X},{default:o(()=>[...e[11]||(e[11]=[b("å–æ¶ˆ",-1)])]),_:1}),t(a,{type:"primary",onClick:Z,loading:N.value},{default:o(()=>[...e[12]||(e[12]=[b(" ä¿å­˜ ",-1)])]),_:1},8,["loading"])],64)):(c(),v(H,{key:0},[t(a,{type:"primary",onClick:W},{default:o(()=>[t(y,null,{default:o(()=>[t(I(re))]),_:1}),e[9]||(e[9]=b(" ç¼–è¾‘ ",-1))]),_:1}),t(a,{type:"danger",onClick:ee},{default:o(()=>[t(y,null,{default:o(()=>[t(I(de))]),_:1}),e[10]||(e[10]=b(" åˆ é™¤ ",-1))]),_:1})],64))])]),t(ae,{modelValue:x.value,"onUpdate:modelValue":e[7]||(e[7]=d=>x.value=d),class:"detail-tabs"},{default:o(()=>[t(D,{label:"åŸºæœ¬ä¿¡æ¯",name:"basic"},{default:o(()=>[l("div",he,[f.value?(c(),O(z,{key:1,ref_key:"formRef",ref:C,model:i,rules:q,"label-width":"100px"},{default:o(()=>[t(R,{gutter:20},{default:o(()=>[t(w,{span:14},{default:o(()=>[t(_,{label:"èŠ‚ç›®åç§°",prop:"title"},{default:o(()=>[t(S,{modelValue:i.title,"onUpdate:modelValue":e[0]||(e[0]=d=>i.title=d),placeholder:"è¯·è¾“å…¥èŠ‚ç›®åç§°",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),t(w,{span:10},{default:o(()=>[t(_,{label:"èŠ‚ç›®åºå·"},{default:o(()=>[t($,{modelValue:i.orderNum,"onUpdate:modelValue":e[1]||(e[1]=d=>i.orderNum=d),min:0,"controls-position":"right",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(R,{gutter:20},{default:o(()=>[t(w,{span:14},{default:o(()=>[t(_,{label:"èŠ‚ç›®ç±»åž‹"},{default:o(()=>[t(te,{modelValue:i.type,"onUpdate:modelValue":e[2]||(e[2]=d=>i.type=d),placeholder:"é€‰æ‹©èŠ‚ç›®ç±»åž‹",style:{width:"100%"},filterable:"","allow-create":"",clearable:""},{default:o(()=>[t(p,{label:"æ­Œèˆž",value:"æ­Œèˆž"}),t(p,{label:"æ­Œæ›²",value:"æ­Œæ›²"}),t(p,{label:"å°å“",value:"å°å“"}),t(p,{label:"ç›¸å£°",value:"ç›¸å£°"}),t(p,{label:"é­”æœ¯",value:"é­”æœ¯"}),t(p,{label:"æ‚æŠ€",value:"æ‚æŠ€"}),t(p,{label:"æˆæ›²",value:"æˆæ›²"}),t(p,{label:"ç»¼è‰º",value:"ç»¼è‰º"}),t(p,{label:"è¯­è¨€",value:"è¯­è¨€"}),t(p,{label:"å…¶ä»–",value:"å…¶ä»–"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(w,{span:10},{default:o(()=>[t(_,{label:"æ—¶é•¿(ç§’)"},{default:o(()=>[t($,{modelValue:i.duration,"onUpdate:modelValue":e[3]||(e[3]=d=>i.duration=d),min:0,step:60,"controls-position":"right",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(_,{label:"è¡¨æ¼”è€…"},{default:o(()=>[t(S,{modelValue:i.performers,"onUpdate:modelValue":e[4]||(e[4]=d=>i.performers=d),placeholder:"è¯·è¾“å…¥è¡¨æ¼”è€…ï¼Œå¤šä¸ªç”¨é€—å·åˆ†éš”",clearable:""},null,8,["modelValue"])]),_:1}),t(_,{label:"èŠ‚ç›®æè¿°"},{default:o(()=>[t(S,{modelValue:i.description,"onUpdate:modelValue":e[5]||(e[5]=d=>i.description=d),type:"textarea",rows:4,placeholder:"è¯·è¾“å…¥èŠ‚ç›®æè¿°ï¼ˆå¯é€‰ï¼‰","show-word-limit":"",maxlength:"500",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])):(c(),v("div",ke,[l("div",Te,[e[13]||(e[13]=l("label",null,"èŠ‚ç›®åç§°",-1)),l("span",xe,r(s.title||"-"),1)]),l("div",Ne,[e[14]||(e[14]=l("label",null,"èŠ‚ç›®åºå·",-1)),l("span",Ce,r(s.orderNum??"-"),1)]),l("div",Se,[e[15]||(e[15]=l("label",null,"èŠ‚ç›®ç±»åž‹",-1)),t(E,{size:"small"},{default:o(()=>[b(r(s.type||"-"),1)]),_:1})]),l("div",De,[e[16]||(e[16]=l("label",null,"æ—¶é•¿",-1)),l("span",Ie,r(L(s.duration)),1)]),l("div",Me,[e[17]||(e[17]=l("label",null,"è¡¨æ¼”è€…",-1)),l("span",je,r(s.performers||"-"),1)]),l("div",Be,[e[18]||(e[18]=l("label",null,"èŠ‚ç›®æè¿°",-1)),l("span",Pe,r(s.description||"-"),1)])]))])]),_:1}),t(D,{label:"æ’­å‡ºä¿¡æ¯",name:"broadcast"},{default:o(()=>{var d;return[l("div",Ae,[f.value?(c(),O(z,{key:1,"label-width":"100px"},{default:o(()=>[t(_,{label:"æ’­å‡ºæ—¶é—´"},{default:o(()=>[t(le,{modelValue:i.airTime,"onUpdate:modelValue":e[6]||(e[6]=V=>i.airTime=V),placeholder:"é€‰æ‹©æ’­å‡ºæ—¶é—´",style:{width:"100%"},"value-format":"HH:mm:ss",clearable:""},null,8,["modelValue"])]),_:1}),t(_,{label:"æ‰€å±žå¹³å°"},{default:o(()=>{var V;return[l("div",qe,[m.value?(c(),v("span",Fe,r(m.value.emoji||"ðŸ“º"),1)):M("",!0),l("span",null,r(((V=m.value)==null?void 0:V.name)||"-"),1)])]}),_:1})]),_:1})):(c(),v("div",Ue,[l("div",Ee,[e[19]||(e[19]=l("label",null,"æ’­å‡ºæ—¶é—´",-1)),l("span",$e,r(s.airTime||"-"),1)]),l("div",Re,[e[20]||(e[20]=l("label",null,"æ‰€å±žå¹³å°",-1)),l("span",ze,[m.value?(c(),v("span",He,r(m.value.emoji||"ðŸ“º"),1)):M("",!0),b(" "+r(((d=m.value)==null?void 0:d.name)||"-"),1)])]),l("div",Ye,[e[21]||(e[21]=l("label",null,"å¹³å°æ’­å‡ºæ—¶é—´",-1)),l("span",Oe,r(K.value),1)])]))])]}),_:1}),t(D,{label:"å®¡æ ¸ä¿¡æ¯",name:"review"},{default:o(()=>[l("div",Ge,[l("div",Ke,[l("div",Le,[e[22]||(e[22]=l("label",null,"å®¡æ ¸çŠ¶æ€",-1)),t(E,{type:G[s.reviewStatus],size:"small"},{default:o(()=>[b(r(F[s.reviewStatus]),1)]),_:1},8,["type"])]),l("div",Je,[e[23]||(e[23]=l("label",null,"åˆ›å»ºæ—¶é—´",-1)),l("span",Qe,r(A(s.createdAt)),1)]),l("div",We,[e[24]||(e[24]=l("label",null,"æ›´æ–°æ—¶é—´",-1)),l("span",Xe,r(A(s.updatedAt)),1)])])])]),_:1})]),_:1},8,["modelValue"])])}}}),st=fe(Ze,[["__scopeId","data-v-c1edc85c"]]);export{st as default};
