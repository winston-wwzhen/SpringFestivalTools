import{h as w}from"./request-BH5mZbvT.js";import{d as Ce,j as ee,v as ke,o as v,c as C,a as c,b as e,w as t,z as le,l as z,y as De,i as m,r as n,A as Se,h as p,t as B,F as ae,C as te,q as Ue,E as _,s as oe}from"./index-5m42ZyK1.js";import{_ as Ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";const je=u=>w.get("/admin/gala/platforms",{params:u}),Fe=u=>w.post("/admin/gala/platforms",u),$e=(u,b)=>w.put(`/admin/gala/platforms/${u}`,b),ze=u=>w.delete(`/admin/gala/platforms/${u}`),Be=u=>w.get("/admin/gala/programs",{params:u}),Ee=u=>w.post("/admin/gala/programs",u),Me=(u,b)=>w.put(`/admin/gala/programs/${u}`,b),Ye=u=>w.delete(`/admin/gala/programs/${u}`),y={adminGetPlatforms:je,createPlatform:Fe,updatePlatform:$e,deletePlatform:ze,adminGetPrograms:Be,createProgram:Ee,updateProgram:Me,deleteProgram:Ye},Re={class:"gala-list-page page-container"},Ie={key:0},qe={class:"actions-bar"},Ge={class:"card"},He={style:{"font-size":"24px"}},Le={key:1},Oe={class:"search-form"},Ae={class:"search-form-item"},Je={key:0,class:"actions-bar"},Ke={class:"card"},Qe=Ce({__name:"List",setup(u){const b=m("platforms"),P=m(!1),E=m([]),M=m([]),re=Ue(()=>E.value.filter(o=>o.reviewStatus==="approved")),h=m(null),T=m(!1),Y=m("æ–°å»ºå¹³å°"),j=m(),R=m(!1),k=m(null),r=ee({name:"",shortName:"",emoji:"ðŸ“º",year:new Date().getFullYear(),airDate:"",airTime:"",channel:"",logo:"",poster:"",description:"",sort:0,isShow:!0,tags:[],tagsText:""}),ne={name:[{required:!0,message:"è¯·è¾“å…¥å¹³å°åç§°",trigger:"blur"}],year:[{required:!0,message:"è¯·è¾“å…¥å¹´ä»½",trigger:"blur"}]},x=m(!1),I=m("æ–°å»ºèŠ‚ç›®"),F=m(),q=m(!1),D=m(null),i=ee({title:"",type:"",performers:"",airTime:"",orderNum:0}),se={title:[{required:!0,message:"è¯·è¾“å…¥èŠ‚ç›®åç§°",trigger:"blur"}]},de={pending:"å¾…å®¡æ ¸",approved:"å·²é€šè¿‡",rejected:"å·²æ‹’ç»"},ue={pending:"warning",approved:"success",rejected:"danger"},$=async()=>{P.value=!0;try{const o=await y.adminGetPlatforms({});E.value=o.list||[]}catch(o){console.error("åŠ è½½å¹³å°å¤±è´¥:",o)}finally{P.value=!1}},G=async()=>{if(h.value){P.value=!0;try{const o=await y.adminGetPrograms({platformId:h.value});M.value=o.list||[]}catch(o){console.error("åŠ è½½èŠ‚ç›®å¤±è´¥:",o)}finally{P.value=!1}}},ie=()=>{b.value==="platforms"&&$()},me=()=>{Y.value="æ–°å»ºå¹³å°",k.value=null,Object.assign(r,{name:"",shortName:"",emoji:"ðŸ“º",year:new Date().getFullYear(),airDate:"",airTime:"",channel:"",logo:"",poster:"",description:"",sort:0,isShow:!0,tags:[],tagsText:""}),T.value=!0},pe=o=>{Y.value="ç¼–è¾‘å¹³å°",k.value=o.id;const l=Array.isArray(o.tags)?o.tags:[];Object.assign(r,{name:o.name,shortName:o.shortName||"",emoji:o.emoji||"ðŸ“º",year:o.year||new Date().getFullYear(),airDate:o.airDate||"",airTime:o.airTime||"",channel:o.channel||"",logo:o.logo||"",poster:o.poster||"",description:o.description||"",sort:o.sort||0,isShow:o.isShow!==void 0?o.isShow:!0,tags:l,tagsText:l.join(", ")}),T.value=!0},fe=async()=>{j.value&&await j.value.validate(async o=>{if(o){R.value=!0;try{const l=r.tagsText?r.tagsText.split(",").map(U=>U.trim()).filter(U=>U):[],S={...r,tags:l};k.value?(await y.updatePlatform(k.value,S),_.success("æ›´æ–°æˆåŠŸ")):(await y.createPlatform(S),_.success("åˆ›å»ºæˆåŠŸ")),T.value=!1,$()}catch(l){_.error(l.message||"æ“ä½œå¤±è´¥")}finally{R.value=!1}}})},ge=async o=>{try{await oe.confirm(`ç¡®å®šè¦åˆ é™¤å¹³å° "${o.name}" å—ï¼Ÿ`,"æç¤º",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),await y.deletePlatform(o.id),_.success("åˆ é™¤æˆåŠŸ"),$()}catch{}},ve=()=>{var o;(o=j.value)==null||o.resetFields(),k.value=null},ce=()=>{if(!h.value){_.warning("è¯·å…ˆé€‰æ‹©å¹³å°");return}I.value="æ–°å»ºèŠ‚ç›®",D.value=null,Object.assign(i,{title:"",type:"",performers:"",airTime:"",orderNum:M.value.length+1}),x.value=!0},_e=o=>{I.value="ç¼–è¾‘èŠ‚ç›®",D.value=o.id,Object.assign(i,{title:o.title,type:o.type||"",performers:o.performers||"",airTime:o.airTime||"",orderNum:o.orderNum||0}),x.value=!0},be=async()=>{F.value&&await F.value.validate(async o=>{if(o){q.value=!0;try{D.value?(await y.updateProgram(D.value,i),_.success("æ›´æ–°æˆåŠŸ")):(await y.createProgram({...i,platform_id:h.value}),_.success("åˆ›å»ºæˆåŠŸ")),x.value=!1,G()}catch(l){_.error(l.message||"æ“ä½œå¤±è´¥")}finally{q.value=!1}}})},Ve=async o=>{try{await oe.confirm(`ç¡®å®šè¦åˆ é™¤èŠ‚ç›® "${o.title}" å—ï¼Ÿ`,"æç¤º",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),await y.deleteProgram(o.id),_.success("åˆ é™¤æˆåŠŸ"),G()}catch{}},ye=()=>{var o;(o=F.value)==null||o.resetFields(),D.value=null};return ke(()=>{$()}),(o,l)=>{const S=n("el-tab-pane"),U=n("el-tabs"),A=n("Plus"),J=n("el-icon"),g=n("el-button"),s=n("el-table-column"),H=n("el-tag"),K=n("el-table"),we=n("el-option"),he=n("el-select"),f=n("el-input"),d=n("el-form-item"),V=n("el-col"),L=n("el-row"),O=n("el-input-number"),Pe=n("el-date-picker"),Q=n("el-time-picker"),Te=n("el-switch"),W=n("el-form"),X=n("el-dialog"),Z=Se("loading");return v(),C("div",Re,[l[37]||(l[37]=c("h2",{class:"page-title"},"æ˜¥æ™šç®¡ç†",-1)),e(U,{modelValue:b.value,"onUpdate:modelValue":l[0]||(l[0]=a=>b.value=a),onTabChange:ie},{default:t(()=>[e(S,{label:"æ˜¥æ™šå¹³å°",name:"platforms"},{label:t(()=>[...l[24]||(l[24]=[c("span",null,"æ˜¥æ™šå¹³å°",-1)])]),_:1}),e(S,{label:"èŠ‚ç›®å•",name:"programs"},{label:t(()=>[...l[25]||(l[25]=[c("span",null,"èŠ‚ç›®å•",-1)])]),_:1})]),_:1},8,["modelValue"]),b.value==="platforms"?(v(),C("div",Ie,[c("div",qe,[e(g,{type:"primary",onClick:me},{default:t(()=>[e(J,null,{default:t(()=>[e(A)]),_:1}),l[26]||(l[26]=p(" æ–°å»ºå¹³å° ",-1))]),_:1})]),c("div",Ge,[le((v(),z(K,{data:E.value},{default:t(()=>[e(s,{prop:"emoji",label:"å›¾æ ‡",width:"60"},{default:t(({row:a})=>[c("span",He,B(a.emoji||"ðŸ“º"),1)]),_:1}),e(s,{prop:"name",label:"å¹³å°åç§°","min-width":"150"}),e(s,{prop:"shortName",label:"ç®€ç§°",width:"60"}),e(s,{prop:"year",label:"å¹´ä»½",width:"70"}),e(s,{prop:"airDate",label:"æ’­å‡ºæ—¥æœŸ",width:"110"}),e(s,{prop:"airTime",label:"æ’­å‡ºæ—¶é—´",width:"90"}),e(s,{prop:"channel",label:"æ’­å‡ºé¢‘é“",width:"120"}),e(s,{prop:"tags",label:"æ ‡ç­¾",width:"200"},{default:t(({row:a})=>[(v(!0),C(ae,null,te(a.tags,(N,xe)=>(v(),z(H,{key:xe,size:"small",style:{"margin-right":"4px"}},{default:t(()=>[p(B(N),1)]),_:2},1024))),128))]),_:1}),e(s,{prop:"isShow",label:"æ˜¾ç¤º",width:"70"},{default:t(({row:a})=>[e(H,{type:a.isShow?"success":"info",size:"small"},{default:t(()=>[p(B(a.isShow?"æ˜¾ç¤º":"éšè—"),1)]),_:2},1032,["type"])]),_:1}),e(s,{prop:"sort",label:"æŽ’åº",width:"70"}),e(s,{label:"æ“ä½œ",width:"200",fixed:"right"},{default:t(({row:a})=>[e(g,{size:"small",onClick:N=>pe(a)},{default:t(()=>[...l[27]||(l[27]=[p("ç¼–è¾‘",-1)])]),_:1},8,["onClick"]),e(g,{size:"small",type:"danger",onClick:N=>ge(a)},{default:t(()=>[...l[28]||(l[28]=[p("åˆ é™¤",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Z,P.value]])])])):(v(),C("div",Le,[c("div",Oe,[c("div",Ae,[l[29]||(l[29]=c("label",null,"é€‰æ‹©å¹³å°",-1)),e(he,{modelValue:h.value,"onUpdate:modelValue":l[1]||(l[1]=a=>h.value=a),placeholder:"è¯·é€‰æ‹©å¹³å°",onChange:G,style:{width:"200px"}},{default:t(()=>[(v(!0),C(ae,null,te(re.value,a=>(v(),z(we,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),h.value?(v(),C("div",Je,[e(g,{type:"primary",onClick:ce},{default:t(()=>[e(J,null,{default:t(()=>[e(A)]),_:1}),l[30]||(l[30]=p(" æ–°å»ºèŠ‚ç›® ",-1))]),_:1})])):De("",!0),c("div",Ke,[le((v(),z(K,{data:M.value},{default:t(()=>[e(s,{prop:"orderNum",label:"åºå·",width:"80"}),e(s,{prop:"title",label:"èŠ‚ç›®åç§°","min-width":"200"}),e(s,{prop:"type",label:"ç±»åž‹",width:"120"}),e(s,{prop:"performers",label:"è¡¨æ¼”è€…","min-width":"200","show-overflow-tooltip":""}),e(s,{prop:"airTime",label:"æ’­å‡ºæ—¶é—´",width:"100"}),e(s,{prop:"reviewStatus",label:"å®¡æ ¸çŠ¶æ€",width:"100"},{default:t(({row:a})=>[e(H,{type:ue[a.reviewStatus],size:"small"},{default:t(()=>[p(B(de[a.reviewStatus]),1)]),_:2},1032,["type"])]),_:1}),e(s,{label:"æ“ä½œ",width:"200",fixed:"right"},{default:t(({row:a})=>[e(g,{size:"small",onClick:N=>_e(a)},{default:t(()=>[...l[31]||(l[31]=[p("ç¼–è¾‘",-1)])]),_:1},8,["onClick"]),e(g,{size:"small",type:"danger",onClick:N=>Ve(a)},{default:t(()=>[...l[32]||(l[32]=[p("åˆ é™¤",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Z,P.value]])])])),e(X,{modelValue:T.value,"onUpdate:modelValue":l[16]||(l[16]=a=>T.value=a),title:Y.value,width:"600px",onClosed:ve},{footer:t(()=>[e(g,{onClick:l[15]||(l[15]=a=>T.value=!1)},{default:t(()=>[...l[33]||(l[33]=[p("å–æ¶ˆ",-1)])]),_:1}),e(g,{type:"primary",onClick:fe,loading:R.value},{default:t(()=>[...l[34]||(l[34]=[p(" ç¡®å®š ",-1)])]),_:1},8,["loading"])]),default:t(()=>[e(W,{ref_key:"platformFormRef",ref:j,model:r,rules:ne,"label-width":"110px"},{default:t(()=>[e(L,{gutter:20},{default:t(()=>[e(V,{span:12},{default:t(()=>[e(d,{label:"å¹³å°åç§°",prop:"name"},{default:t(()=>[e(f,{modelValue:r.name,"onUpdate:modelValue":l[2]||(l[2]=a=>r.name=a),placeholder:"å¦‚ï¼šå¤®è§†æ˜¥æ™šã€æ²³å—æ˜¥æ™šç­‰"},null,8,["modelValue"])]),_:1})]),_:1}),e(V,{span:6},{default:t(()=>[e(d,{label:"ç®€ç§°",prop:"shortName"},{default:t(()=>[e(f,{modelValue:r.shortName,"onUpdate:modelValue":l[3]||(l[3]=a=>r.shortName=a),placeholder:"å¤®",maxlength:"1"},null,8,["modelValue"])]),_:1})]),_:1}),e(V,{span:6},{default:t(()=>[e(d,{label:"Emojiå›¾æ ‡"},{default:t(()=>[e(f,{modelValue:r.emoji,"onUpdate:modelValue":l[4]||(l[4]=a=>r.emoji=a),placeholder:"ðŸ“º",maxlength:"2"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(L,{gutter:20},{default:t(()=>[e(V,{span:8},{default:t(()=>[e(d,{label:"å¹´ä»½",prop:"year"},{default:t(()=>[e(O,{modelValue:r.year,"onUpdate:modelValue":l[5]||(l[5]=a=>r.year=a),min:2e3,max:2100,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(V,{span:8},{default:t(()=>[e(d,{label:"æ’­å‡ºæ—¥æœŸ"},{default:t(()=>[e(Pe,{modelValue:r.airDate,"onUpdate:modelValue":l[6]||(l[6]=a=>r.airDate=a),type:"date",placeholder:"é€‰æ‹©æ’­å‡ºæ—¥æœŸ",style:{width:"100%"},"value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1}),e(V,{span:8},{default:t(()=>[e(d,{label:"æ’­å‡ºæ—¶é—´"},{default:t(()=>[e(Q,{modelValue:r.airTime,"onUpdate:modelValue":l[7]||(l[7]=a=>r.airTime=a),placeholder:"é€‰æ‹©æ’­å‡ºæ—¶é—´",style:{width:"100%"},"value-format":"HH:mm:ss"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(d,{label:"æ’­å‡ºé¢‘é“"},{default:t(()=>[e(f,{modelValue:r.channel,"onUpdate:modelValue":l[8]||(l[8]=a=>r.channel=a),placeholder:"å¦‚ï¼šCCTV-1ã€æ²³å—å«è§†ç­‰"},null,8,["modelValue"])]),_:1}),e(d,{label:"æ ‡ç­¾ï¼ˆé€—å·åˆ†éš”ï¼‰"},{default:t(()=>[e(f,{modelValue:r.tagsText,"onUpdate:modelValue":l[9]||(l[9]=a=>r.tagsText=a),placeholder:"å¤®è§†, ä¸»ä¼šåœº, å…¨çƒç›´æ’­"},null,8,["modelValue"])]),_:1}),e(d,{label:"Logoåœ°å€"},{default:t(()=>[e(f,{modelValue:r.logo,"onUpdate:modelValue":l[10]||(l[10]=a=>r.logo=a),placeholder:"/images/gala/cctv-logo.png"},null,8,["modelValue"])]),_:1}),e(d,{label:"æµ·æŠ¥åœ°å€"},{default:t(()=>[e(f,{modelValue:r.poster,"onUpdate:modelValue":l[11]||(l[11]=a=>r.poster=a),placeholder:"/images/gala/cctv-poster.png"},null,8,["modelValue"])]),_:1}),e(d,{label:"æè¿°"},{default:t(()=>[e(f,{modelValue:r.description,"onUpdate:modelValue":l[12]||(l[12]=a=>r.description=a),type:"textarea",rows:3,placeholder:"è¯·è¾“å…¥æè¿°"},null,8,["modelValue"])]),_:1}),e(L,{gutter:20},{default:t(()=>[e(V,{span:12},{default:t(()=>[e(d,{label:"æŽ’åº"},{default:t(()=>[e(O,{modelValue:r.sort,"onUpdate:modelValue":l[13]||(l[13]=a=>r.sort=a),min:0},null,8,["modelValue"])]),_:1})]),_:1}),e(V,{span:12},{default:t(()=>[e(d,{label:"æ˜¯å¦æ˜¾ç¤º"},{default:t(()=>[e(Te,{modelValue:r.isShow,"onUpdate:modelValue":l[14]||(l[14]=a=>r.isShow=a)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(X,{modelValue:x.value,"onUpdate:modelValue":l[23]||(l[23]=a=>x.value=a),title:I.value,width:"600px",onClosed:ye},{footer:t(()=>[e(g,{onClick:l[22]||(l[22]=a=>x.value=!1)},{default:t(()=>[...l[35]||(l[35]=[p("å–æ¶ˆ",-1)])]),_:1}),e(g,{type:"primary",onClick:be,loading:q.value},{default:t(()=>[...l[36]||(l[36]=[p(" ç¡®å®š ",-1)])]),_:1},8,["loading"])]),default:t(()=>[e(W,{ref_key:"programFormRef",ref:F,model:i,rules:se,"label-width":"100px"},{default:t(()=>[e(d,{label:"èŠ‚ç›®åç§°",prop:"title"},{default:t(()=>[e(f,{modelValue:i.title,"onUpdate:modelValue":l[17]||(l[17]=a=>i.title=a),placeholder:"è¯·è¾“å…¥èŠ‚ç›®åç§°"},null,8,["modelValue"])]),_:1}),e(d,{label:"èŠ‚ç›®ç±»åž‹"},{default:t(()=>[e(f,{modelValue:i.type,"onUpdate:modelValue":l[18]||(l[18]=a=>i.type=a),placeholder:"å¦‚ï¼šæ­Œèˆžã€å°å“ã€ç›¸å£°ç­‰"},null,8,["modelValue"])]),_:1}),e(d,{label:"è¡¨æ¼”è€…"},{default:t(()=>[e(f,{modelValue:i.performers,"onUpdate:modelValue":l[19]||(l[19]=a=>i.performers=a),placeholder:"è¯·è¾“å…¥è¡¨æ¼”è€…ï¼Œå¤šä¸ªç”¨é€—å·åˆ†éš”"},null,8,["modelValue"])]),_:1}),e(d,{label:"æ’­å‡ºæ—¶é—´"},{default:t(()=>[e(Q,{modelValue:i.airTime,"onUpdate:modelValue":l[20]||(l[20]=a=>i.airTime=a),placeholder:"é€‰æ‹©æ’­å‡ºæ—¶é—´",style:{width:"100%"},"value-format":"HH:mm:ss"},null,8,["modelValue"])]),_:1}),e(d,{label:"èŠ‚ç›®åºå·"},{default:t(()=>[e(O,{modelValue:i.orderNum,"onUpdate:modelValue":l[21]||(l[21]=a=>i.orderNum=a),min:0},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),el=Ne(Qe,[["__scopeId","data-v-fc29cf72"]]);export{el as default};
