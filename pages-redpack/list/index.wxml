<!--pages-redpack/list/index.wxml-->
<view class="container">
  <!-- æœç´¢æ  -->
  <view class="search-bar">
    <view class="search-input">
      <image class="search-icon" src="/images/icon-search.png" mode="aspectFit"></image>
      <input placeholder="æœç´¢çº¢åŒ…æ´»åŠ¨" value="{{searchKeyword}}" bindinput="onSearchInput" confirm-type="search" bindconfirm="onSearch" />
    </view>
  </view>

  <!-- ç­›é€‰æ ‡ç­¾ -->
  <view class="filter-tabs">
    <view class="tab-item {{activeTab === 'all' ? 'active' : ''}}" data-tab="all" bindtap="onTabChange">
      å…¨éƒ¨
    </view>
    <view class="tab-item {{activeTab === 'ongoing' ? 'active' : ''}}" data-tab="ongoing" bindtap="onTabChange">
      è¿›è¡Œä¸­
    </view>
    <view class="tab-item {{activeTab === 'upcoming' ? 'active' : ''}}" data-tab="upcoming" bindtap="onTabChange">
      å³å°†å¼€å§‹
    </view>
    <view class="tab-item {{activeTab === 'ended' ? 'active' : ''}}" data-tab="ended" bindtap="onTabChange">
      å·²ç»“æŸ
    </view>
  </view>

  <!-- æ´»åŠ¨åˆ—è¡¨ -->
  <view class="activity-list">
    <block wx:if="{{list.length > 0}}">
      <view class="activity-card" wx:for="{{list}}" wx:key="id" bindtap="goToDetail" data-id="{{item.id}}">
        <view class="card-header">
          <image class="platform-icon" src="{{item.platform_icon || '/images/icon-platform.png'}}" mode="aspectFit"></image>
          <view class="platform-name">{{item.platform_name}}</view>
          <view class="status-tag status-{{item.status}}">{{item.status_text}}</view>
        </view>

        <view class="card-body">
          <view class="activity-title">{{item.title}}</view>
          <view class="activity-desc">{{item.description}}</view>
        </view>

        <view class="card-footer">
          <view class="time-info">
            <text class="icon">â°</text>
            <text>{{item.start_time}} - {{item.end_time}}</text>
          </view>
          <view class="reward-amount" wx:if="{{item.max_reward}}">
            <text class="icon">ğŸ§§</text>
            <text>æœ€é«˜ {{item.max_reward}}</text>
          </view>
        </view>

        <view class="card-tags" wx:if="{{item.tags && item.tags.length > 0}}">
          <view class="tag" wx:for="{{item.tags}}" wx:key="*this" wx:for-item="tag">{{tag}}</view>
        </view>
      </view>
    </block>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{list.length === 0 && !loading}}">
      <image class="empty-icon" src="/images/empty.png" mode="aspectFit"></image>
      <text class="empty-text">æš‚æ— çº¢åŒ…æ´»åŠ¨</text>
    </view>

    <!-- åŠ è½½ä¸­ -->
    <view class="loading-state" wx:if="{{loading}}">
      <text>åŠ è½½ä¸­...</text>
    </view>
  </view>
</view>