<!--pages-redpack/detail/index.wxml-->
<view class="container">
  <!-- å¤´éƒ¨ä¿¡æ¯ -->
  <view class="header">
    <view class="platform-info">
      <image class="platform-icon" src="{{activity.platform_icon}}" mode="aspectFit"></image>
      <view class="platform-name">{{activity.platform_name}}</view>
    </view>
    <view class="status-badge status-{{activity.status}}">{{activity.status_text}}</view>
  </view>

  <!-- æ´»åŠ¨æ ‡é¢˜ -->
  <view class="title-section">
    <text class="title">{{activity.title}}</text>
    <view class="reward" wx:if="{{activity.max_reward}}">
      <text class="reward-icon">ğŸ§§</text>
      <text class="reward-text">æœ€é«˜ {{activity.max_reward}}</text>
    </view>
  </view>

  <!-- æ´»åŠ¨æ—¶é—´ -->
  <view class="time-section">
    <view class="time-item">
      <text class="time-label">å¼€å§‹æ—¶é—´</text>
      <text class="time-value">{{activity.start_time}}</text>
    </view>
    <view class="time-divider"></view>
    <view class="time-item">
      <text class="time-label">ç»“æŸæ—¶é—´</text>
      <text class="time-value">{{activity.end_time}}</text>
    </view>
  </view>

  <!-- æ ‡ç­¾ -->
  <view class="tags-section" wx:if="{{activity.tags && activity.tags.length > 0}}">
    <view class="tag" wx:for="{{activity.tags}}" wx:key="*this">#{{item}}</view>
  </view>

  <!-- æ ¸å¿ƒæ•°æ® -->
  <view class="stats-section" wx:if="{{activity.detail}}">
    <view class="stat-item" wx:if="{{activity.detail.total_bonus}}">
      <text class="stat-label">å¥–é‡‘æ€»é¢</text>
      <text class="stat-value">{{activity.detail.total_bonus}}</text>
    </view>
    <view class="stat-divider" wx:if="{{activity.detail.participation}}"></view>
    <view class="stat-item" wx:if="{{activity.detail.participation}}">
      <text class="stat-label">å‚ä¸äººæ•°</text>
      <text class="stat-value">{{activity.detail.participation}}</text>
    </view>
  </view>

  <!-- æ´»åŠ¨æè¿° -->
  <view class="desc-section">
    <text class="desc-text">{{activity.description}}</text>
  </view>

  <!-- è¯¦ç»†å†…å®¹æŠ˜å é¢æ¿ -->
  <view class="content-section" wx:if="{{activity.detail}}">
    <!-- æ´»åŠ¨è§„åˆ™ -->
    <view class="accordion-item">
      <view class="accordion-header" bindtap="toggleRules">
        <text class="accordion-title">ğŸ“œ æ´»åŠ¨è§„åˆ™</text>
        <text class="accordion-arrow {{showRules ? 'expanded' : ''}}">â–¼</text>
      </view>
      <view class="accordion-content {{showRules ? 'show' : ''}}" wx:if="{{activity.detail.rules}}">
        <text class="rules-text">{{activity.detail.rules}}</text>
      </view>
    </view>

    <!-- å‚ä¸æ­¥éª¤ -->
    <view class="accordion-item">
      <view class="accordion-header" bindtap="toggleSteps">
        <text class="accordion-title">ğŸ“ å‚ä¸æ­¥éª¤</text>
        <text class="accordion-arrow {{showSteps ? 'expanded' : ''}}">â–¼</text>
      </view>
      <view class="accordion-content {{showSteps ? 'show' : ''}}" wx:if="{{activity.detail.steps}}">
        <view class="steps-list">
          <view class="step-item" wx:for="{{activity.detail.steps}}" wx:key="*this">
            <view class="step-dot">{{index + 1}}</view>
            <text class="step-text">{{item}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- è·å¥–æŠ€å·§ -->
    <view class="accordion-item" wx:if="{{activity.detail.tips}}">
      <view class="accordion-header" bindtap="toggleTips">
        <text class="accordion-title">ğŸ’¡ è·å¥–æŠ€å·§</text>
        <text class="accordion-arrow {{showTips ? 'expanded' : ''}}">â–¼</text>
      </view>
      <view class="accordion-content {{showTips ? 'show' : ''}}">
        <view class="tips-list">
          <view class="tip-item" wx:for="{{activity.detail.tips}}" wx:key="*this">
            <text class="tip-dot">â€¢</text>
            <text class="tip-text">{{item}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æŒ‰é’® -->
  <view class="footer">
    <button class="btn-share" bindtap="onShare">
      <text>ğŸ“¤ åˆ†äº«ç»™å¥½å‹</text>
    </button>
    <button class="btn-primary" bindtap="goToPlatform">
      <text>ğŸš€ ç«‹å³å‚ä¸</text>
    </button>
  </view>
</view>