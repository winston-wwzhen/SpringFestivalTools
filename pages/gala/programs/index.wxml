<!--pages-gala/programs/index.wxml-->
<view class="container">
  <nav-bar title="èŠ‚ç›®å•" bgColor="#D32F2F" showBack="{{true}}"></nav-bar>

  <!-- è£…é¥°ç¯ç¬¼ -->
  <view class="lantern-left">ğŸ®</view>
  <view class="lantern-right">ğŸ®</view>

  <!-- æœç´¢æ  -->
  <view class="search-container">
    <view class="search-box">
      <text class="search-icon">ğŸ”</text>
      <input
        class="search-input"
        type="text"
        placeholder="æœç´¢èŠ‚ç›®æˆ–è¡¨æ¼”è€…"
        value="{{searchKeyword}}"
        bindinput="onSearchInput"
        confirm-type="search"
        bindconfirm="onSearchConfirm"
      />
      <view class="clear-icon" wx:if="{{searchKeyword}}" bindtap="onClearSearch">
        <text>âœ•</text>
      </view>
    </view>
  </view>

  <!-- å¹³å°ä¿¡æ¯ -->
  <view class="platform-header" wx:if="{{platform}}">
    <view class="platform-logo">{{platform.emoji || 'ğŸ“º'}}</view>
    <view class="platform-info">
      <view class="platform-name">{{platform.name}}</view>
      <view class="platform-time">ğŸ• {{platform.broadcast_time}}</view>
    </view>
    <view class="program-total">{{programs.length > 0 ? 'å…±' + programs.length + 'ä¸ªèŠ‚ç›®' : 'èŠ‚ç›®å•æœªå…¬å¸ƒ'}}</view>
  </view>

  <!-- èŠ‚ç›®åˆ—è¡¨ -->
  <view class="program-list">
    <view
      class="program-card"
      wx:for="{{filteredPrograms}}"
      wx:key="id"
      bindtap="onProgramClick"
      data-id="{{item.id}}"
    >
      <view class="program-order">{{item.order}}</view>
      <view class="program-info">
        <view class="program-name">
          <text class="name-text">{{item.name}}</text>
          <view class="fav-icon {{item.isFav ? 'active' : ''}}" catchtap="onToggleFav" data-id="{{item.id}}">
            <text>{{item.isFav ? 'â­' : 'â˜†'}}</text>
          </view>
        </view>
        <view class="program-performers" wx:if="{{item.performers}}">
          <text class="performers-icon">ğŸ‘¤</text>
          <text>{{item.performers}}</text>
        </view>
      </view>
      <view class="program-type {{getTypeColor(item.type)}}">{{item.type}}</view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{filteredPrograms.length === 0 && !loading}}">
      <text class="empty-icon">ğŸ“­</text>
      <text class="empty-text">èŠ‚ç›®å•æœªå‘å¸ƒ</text>
      <text class="empty-hint">2026æ˜¥æ™šèŠ‚ç›®å•å°šæœªå…¬å¸ƒ</text>
    </view>

    <!-- åŠ è½½ä¸­ -->
    <view class="loading-state" wx:if="{{loading}}">
      <text>åŠ è½½ä¸­...</text>
    </view>
  </view>
</view>
