<!--pages-redpack/list/index.wxml-->
<view class="container">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <nav-bar title="çº¢åŒ…æ”»ç•¥" bgColor="#D32F2F"></nav-bar>

  <!-- è£…é¥°ç¯ç¬¼ -->
  <view class="lantern-left">ğŸ®</view>
  <view class="lantern-right">ğŸ®</view>

  <!-- æœç´¢æ  -->
  <view class="search-bar">
    <view class="search-box">
      <text class="search-icon">ğŸ”</text>
      <input class="search-input" placeholder="æœç´¢æ´»åŠ¨åç§°æˆ–å¹³å°" value="{{searchKeyword}}" bindinput="onSearchInput" confirm-type="search" bindconfirm="onSearch" />
      <view class="clear-icon {{searchKeyword ? 'show' : ''}}" bindtap="onClearSearch">
        <text>âœ•</text>
      </view>
    </view>
  </view>

  <!-- å…è´£å£°æ˜ -->
  <view class="disclaimer-box">
    <text class="disclaimer-icon">ğŸ“¢</text>
    <text class="disclaimer-text">æœ¬é¡µé¢ä»…ä¸ºæ´»åŠ¨ä¿¡æ¯æ•´ç†ï¼Œå…·ä½“æ´»åŠ¨è§„åˆ™ä»¥å„å¹³å°å®˜æ–¹ä¸ºå‡†</text>
  </view>

  <!-- ç­›é€‰æ ‡ç­¾ -->
  <view class="filter-tabs">
    <view class="tab-item {{activeTab === 'all' ? 'active' : ''}}" data-tab="all" bindtap="onTabChange">
      å…¨éƒ¨
    </view>
    <view class="tab-item {{activeTab === 'ongoing' ? 'active' : ''}}" data-tab="ongoing" bindtap="onTabChange">
      è¿›è¡Œä¸­
    </view>
    <view class="tab-item {{activeTab === 'upcoming' ? 'active' : ''}}" data-tab="upcoming" bindtap="onTabChange">
      å³å°†å¼€å§‹
    </view>
    <view class="tab-item {{activeTab === 'ended' ? 'active' : ''}}" data-tab="ended" bindtap="onTabChange">
      å·²ç»“æŸ
    </view>
  </view>

  <!-- é¡µé¢çŠ¶æ€ï¼šåŠ è½½ä¸­ -->
  <skeleton wx:if="{{pageStatus === 'loading'}}" type="card" rows="{{3}}" animate="{{true}}"></skeleton>

  <!-- é¡µé¢çŠ¶æ€ï¼šé”™è¯¯ -->
  <error-state 
    wx:if="{{pageStatus === 'error'}}"
    icon="ğŸ“¡"
    title="åŠ è½½å¤±è´¥"
    description="ç½‘ç»œå¼‚å¸¸ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®åé‡è¯•"
    bind:retry="loadData">
  </error-state>

  <!-- é¡µé¢çŠ¶æ€ï¼šç©ºæ•°æ® -->
  <empty-state 
    wx:if="{{pageStatus === 'empty'}}"
    icon="ğŸ§§"
    title="æš‚æ— çº¢åŒ…æ´»åŠ¨"
    description="æš‚æ—¶æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„çº¢åŒ…æ´»åŠ¨ï¼Œæ¢ä¸ªç­›é€‰æ¡ä»¶è¯•è¯•å§"
    showButton="{{true}}"
    buttonText="æ¸…é™¤ç­›é€‰"
    bind:tap="onClearSearch">
  </empty-state>

  <!-- é¡µé¢çŠ¶æ€ï¼šæ­£å¸¸å†…å®¹ -->
  <view class="activity-list" wx:if="{{pageStatus === 'content'}}">
    <view class="activity-card" wx:for="{{list}}" wx:key="id" bindtap="goToDetail" data-id="{{item.id}}">
      <view class="card-header">
        <view class="platform-emoji">{{item.platform_emoji || 'ğŸ®'}}</view>
        <view class="platform-name">{{item.platform_name}}</view>
        <view class="status-tag status-{{item.status}}">{{item.status_text}}</view>
      </view>

      <view class="card-body">
        <view class="activity-title">{{item.title}}</view>
        <view class="activity-desc">{{item.description}}</view>
      </view>

      <view class="card-footer">
        <view class="time-info">
          <text class="icon">â°</text>
          <text>{{item.start_time}} - {{item.end_time}}</text>
        </view>
        <view class="reward-amount" wx:if="{{item.max_reward}}">
          <text class="icon">ğŸ§§</text>
          <text>æœ€é«˜ {{item.max_reward}}</text>
        </view>
      </view>

      <view class="card-tags" wx:if="{{item.tags && item.tags.length > 0}}">
        <view class="tag" wx:for="{{item.tags}}" wx:key="*this" wx:for-item="tag">{{tag}}</view>
      </view>
    </view>

    <!-- åŠ è½½æ›´å¤š -->
    <view class="load-more" wx:if="{{hasMore && list.length > 0}}">
      <text>åŠ è½½æ›´å¤š...</text>
    </view>
    <view class="no-more" wx:if="{{!hasMore && list.length > 5}}">
      <text>å·²ç»åˆ°åº•å•¦~</text>
    </view>
  </view>
</view>
