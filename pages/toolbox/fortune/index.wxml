<!--pages/toolbox/fortune/index.wxml-->
<view class="page">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <nav-bar title="æ–°å¹´è¿åŠ¿" bgColor="#B71C1C" showBack="{{true}}"></nav-bar>

  <!-- å¤´éƒ¨ -->
  <view class="header">
    <view class="header-bg"></view>
    <view class="header-content">
      <view class="title">ğŸ”® æ–°å¹´è¿åŠ¿</view>
      <view class="subtitle">æµ‹ç®—2026é©¬å¹´è¿åŠ¿</view>
    </view>
  </view>

  <!-- è¾“å…¥åŒºåŸŸ -->
  <view class="form-section">
    <view class="form-item">
      <view class="label">æ‚¨çš„å§“å</view>
      <input class="input" placeholder="è¯·è¾“å…¥å§“å" value="{{name}}" bindinput="onNameInput" />
    </view>

    <view class="form-item">
      <view class="label">å‡ºç”Ÿæ—¥æœŸ</view>
      <picker mode="date" value="{{birthday}}" end="{{currentDate}}" bindchange="onBirthdayChange">
        <view class="picker {{birthday ? '' : 'placeholder'}}">
          {{birthday || 'è¯·é€‰æ‹©å‡ºç”Ÿæ—¥æœŸ'}}
        </view>
      </picker>
    </view>

    <view class="form-item">
      <view class="label">æ‚¨çš„æ€§åˆ«</view>
      <view class="radio-group">
        <view class="radio-item {{gender === 'male' ? 'active' : ''}}" bindtap="onGenderSelect" data-gender="male">
          <text class="radio-icon">{{gender === 'male' ? 'â—' : 'â—‹'}}</text>
          <text>ç”·</text>
        </view>
        <view class="radio-item {{gender === 'female' ? 'active' : ''}}" bindtap="onGenderSelect" data-gender="female">
          <text class="radio-icon">{{gender === 'female' ? 'â—' : 'â—‹'}}</text>
          <text>å¥³</text>
        </view>
      </view>
    </view>

    <view class="form-item">
      <view class="label">æµ‹ç®—é‡ç‚¹ï¼ˆå¯é€‰ï¼‰</view>
      <view class="keyword-group">
        <view class="keyword-item {{keyword === 'love' ? 'active' : ''}}" bindtap="onKeywordSelect" data-keyword="love">
          <text class="keyword-icon">â¤ï¸</text>
          <text class="keyword-text">çˆ±æƒ…</text>
        </view>
        <view class="keyword-item {{keyword === 'career' ? 'active' : ''}}" bindtap="onKeywordSelect" data-keyword="career">
          <text class="keyword-icon">ğŸ’¼</text>
          <text class="keyword-text">äº‹ä¸š</text>
        </view>
        <view class="keyword-item {{keyword === 'wealth' ? 'active' : ''}}" bindtap="onKeywordSelect" data-keyword="wealth">
          <text class="keyword-icon">ğŸ’°</text>
          <text class="keyword-text">è´¢å¯Œ</text>
        </view>
        <view class="keyword-item {{keyword === 'health' ? 'active' : ''}}" bindtap="onKeywordSelect" data-keyword="health">
          <text class="keyword-icon">ğŸ¥</text>
          <text class="keyword-text">å¥åº·</text>
        </view>
        <view class="keyword-item {{keyword === 'study' ? 'active' : ''}}" bindtap="onKeywordSelect" data-keyword="study">
          <text class="keyword-icon">ğŸ“š</text>
          <text class="keyword-text">å­¦ä¸š</text>
        </view>
        <view class="keyword-item {{keyword === 'family' ? 'active' : ''}}" bindtap="onKeywordSelect" data-keyword="family">
          <text class="keyword-icon">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</text>
          <text class="keyword-text">å®¶åº­</text>
        </view>
      </view>
      <view class="keyword-hint">é€‰æ‹©åå¯è·å¾—æ›´è¯¦ç»†çš„ä¸“é¡¹è§£è¯»</view>
    </view>

    <button class="btn-calculate" bindtap="calculateFortune" disabled="{{loading}}">
      {{loading ? 'æµ‹ç®—ä¸­...' : 'ğŸ”® å¼€å§‹æµ‹ç®—'}}
    </button>
  </view>

  <!-- è¿åŠ¿ç»“æœ -->
  <view class="result-section" wx:if="{{fortuneResult}}">
    <view class="result-header">
      <text class="result-title">ğŸŠ {{fortuneResult.name}}çš„2026é©¬å¹´è¿åŠ¿</text>
    </view>

    <!-- ç»¼åˆè¿åŠ¿ -->
    <view class="fortune-card overall">
      <view class="card-title">â­ ç»¼åˆè¿åŠ¿</view>
      <view class="star-rating">
        <text wx:for="{{fortuneResult.overallStars}}" wx:key="index" class="star">â˜…</text>
      </view>
      <view class="fortune-desc">{{fortuneResult.overfallDesc}}</view>
    </view>

    <!-- å„é¡¹è¿åŠ¿ -->
    <view class="fortune-list">
      <view class="fortune-item">
        <view class="fortune-label">ğŸ’° è´¢è¿</view>
        <view class="fortune-bar">
          <view class="bar-fill" style="width: {{fortuneResult.wealth}}%"></view>
        </view>
        <view class="fortune-value">{{fortuneResult.wealth}}%</view>
      </view>

      <view class="fortune-item">
        <view class="fortune-label">ğŸ’¼ äº‹ä¸š</view>
        <view class="fortune-bar">
          <view class="bar-fill" style="width: {{fortuneResult.career}}%"></view>
        </view>
        <view class="fortune-value">{{fortuneResult.career}}%</view>
      </view>

      <view class="fortune-item">
        <view class="fortune-label">â¤ï¸ çˆ±æƒ…</view>
        <view class="fortune-bar">
          <view class="bar-fill" style="width: {{fortuneResult.love}}%"></view>
        </view>
        <view class="fortune-value">{{fortuneResult.love}}%</view>
      </view>

      <view class="fortune-item">
        <view class="fortune-label">ğŸ¥ å¥åº·</view>
        <view class="fortune-bar">
          <view class="bar-fill" style="width: {{fortuneResult.health}}%"></view>
        </view>
        <view class="fortune-value">{{fortuneResult.health}}%</view>
      </view>
    </view>

    <!-- å¹¸è¿å…ƒç´  -->
    <view class="lucky-section">
      <view class="lucky-title">ğŸ€ å¹¸è¿å…ƒç´ </view>
      <view class="lucky-grid">
        <view class="lucky-item">
          <view class="lucky-label">å¹¸è¿é¢œè‰²</view>
          <view class="lucky-value">{{fortuneResult.luckyColor}}</view>
        </view>
        <view class="lucky-item">
          <view class="lucky-label">å¹¸è¿æ•°å­—</view>
          <view class="lucky-value">{{fortuneResult.luckyNumber}}</view>
        </view>
        <view class="lucky-item">
          <view class="lucky-label">å¹¸è¿æ–¹ä½</view>
          <view class="lucky-value">{{fortuneResult.luckyDirection}}</view>
        </view>
        <view class="lucky-item">
          <view class="lucky-label">å¹¸è¿ç”Ÿè‚–</view>
          <view class="lucky-value">{{fortuneResult.luckyZodiac}}</view>
        </view>
      </view>
    </view>

    <!-- è¿åŠ¿å»ºè®® -->
    <view class="advice-section">
      <view class="advice-title">ğŸ’¡ æ–°å¹´å¯„è¯­</view>
      <view class="advice-content">{{fortuneResult.advice}}</view>
    </view>
  </view>
</view>
